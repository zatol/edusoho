(window.webpackJsonp=window.webpackJsonp||[]).push([["login"],{7067:function(e,t,i){"use strict";i("e17f");var n=i("2241"),a=(i("e7e5"),i("d399")),r=i("a026"),s=i("3ce7"),o=/micromessenger/.test(navigator.userAgent.toLowerCase());t.a=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||i&&!t)a.a.fail("缺少分享参数");else{var c={domainUri:location.origin,itemUri:"",source:"h5"};s.a.marketingActivities({query:{activityId:e},data:c}).then((function(e){var s=-1!==e.url.indexOf("?")?"&":"?",c=i?"".concat(t).concat(s,"ticket=").concat(e.ticket):e.url;o?window.location.href=c:n.a.confirm({message:"去微信完成活动",confirmButtonText:"复制链接",title:""}).then((function(){try{r.a.prototype.$copyText(c).then((function(){a.a.success("复制成功")}),(function(){a.a.fail("请更换浏览器复制")}))}catch(e){a.a.fail("请更换浏览器复制")}})).catch((function(){}))})).catch((function(e){a.a.fail(e.message)}))}}},"89eb":function(e,t,i){"use strict";i.r(t),i("e7e5");var n=i("d399"),a=i("db72"),r=i("2f62"),s=i("3ce7"),o={data:function(){return{username:"",password:"",faceRegistered:0,errorMessage:{password:""}}},computed:{btnSubmitDisable:function(){return!this.username},btnDisable:function(){return!(this.username&&this.password)}},methods:Object(a.a)({},Object(r.b)(["userLogin"]),{onSubmitInfo:function(){var e,t=this;e=/^1\d{10}$/.test(this.username)?"mobile":/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(this.username)?"email":"nickname",s.a.getUserIsExisted({query:{type:this.username},params:{identifyType:e}}).then((function(e){e.id?"0"===e.faceRegistered?(t.faceRegistered=e.faceRegistered,Object(n.a)({duration:2e3,message:"初次使用请验证密码"})):t.$router.push({name:"verification",query:{redirect:t.$route.query.redirect||"",loginToken:t.$route.query.loginToken||"",type:"compare",faceRegistered:0,loginField:t.username}}):n.a.fail({duration:2e3,message:"用户不存在"})})).catch((function(e){n.a.fail(e.message)}))},checkName:function(){this.faceRegistered=0},onCheckExisted:function(){var e=this;this.userLogin({username:this.username,password:this.password}).then((function(t){e.$router.push({name:"verification",query:{redirect:e.$route.query.redirect||"",loginToken:e.$route.query.loginToken||"",type:"register",faceRegistered:1}})})).catch((function(e){n.a.fail(e.message)}))}})},c=i("a6c2"),u=Object(c.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"login"},[i("span",{staticClass:"login-title"},[e._v("确认账号")]),i("van-field",{staticClass:"login-input e-input",attrs:{placeholder:"请输入邮箱/手机/用户名"},on:{input:e.checkName},model:{value:e.username,callback:function(t){e.username="string"==typeof t?t.trim():t},expression:"username"}}),e.faceRegistered?i("van-field",{staticClass:"login-input e-input",attrs:{"error-message":e.errorMessage.password,type:"password",placeholder:"请输入密码"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}):e._e(),e.faceRegistered?i("van-button",{staticClass:"primary-btn mb20",attrs:{disabled:e.btnDisable,type:"default"},on:{click:e.onCheckExisted}},[e._v("下一步")]):i("van-button",{staticClass:"primary-btn mb20",attrs:{disabled:e.btnSubmitDisable,type:"default"},on:{click:e.onSubmitInfo}},[e._v("下一步")])],1)}),[],!1,null,null,null);t.default=u.exports},a262:function(e,t,i){"use strict";var n=i("7067");t.a={methods:{activityHandle:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(n.a)(e,t,i)}}}},affc:function(e,t,i){"use strict";i.r(t),i("a481"),i("c5f6");var n=i("db72"),a=(i("e7e5"),i("d399")),r=(i("96cf"),i("3b8d")),s=(i("a262"),i("d863")),o=i("2f62"),c=i("3ce7"),u={mixins:[s.a],data:function(){return{username:"",password:"",errorMessage:{password:""},faceSetting:0,bodyHeight:520,loginConfig:{},cloudSetting:!1}},computed:{btnDisable:function(){return!(this.username&&this.password)},isWeixinBrowser:function(){return/micromessenger/.test(navigator.userAgent.toLowerCase())},canloginConfig:function(){return!this.$route.query||!this.$route.query.forbidWxLogin}},created:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.$store.state.token){e.next=4;break}return a.a.loading({message:"请稍后"}),this.afterLogin(),e.abrupt("return");case 4:return e.next=6,c.a.getSettings({query:{type:"register"}}).catch((function(e){a.a.fail(e.message)}));case 6:this.registerSettings=e.sent,this.getsettingsCloud();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),mounted:function(){this.bodyHeight=document.documentElement.clientHeight-46,this.username=this.$route.params.username||this.$route.query.account||"",a.a.loading({message:"请稍后"}),this.faceLogin(),this.thirdPartyLogin()},methods:Object(n.a)({},Object(o.b)(["userLogin"]),{getsettingsCloud:function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.settingsCloud().then((function(e){t.cloudSetting=!!e.sms_enabled})).catch((function(e){a.a.fail(e.message)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onSubmit:function(e){var t=this;this.userLogin({username:this.username,password:this.password}).then((function(e){a.a.success({duration:2e3,message:"登录成功"}),t.afterLogin()})).catch((function(e){a.a.fail(e.message)}))},jumpRegister:function(){this.registerSettings&&"closed"!==this.registerSettings.mode&&"email"!==this.registerSettings.mode?this.$router.push({name:"register",query:{redirect:this.$route.query.redirect||"/"}}):Object(a.a)("网校未开启手机注册，请联系管理员")},faceLogin:function(){var e=this;c.a.settingsFace({}).then((function(t){Number(t.login.enabled)?e.faceSetting=Number(t.login.h5_enabled):e.faceSetting=0})).catch((function(e){a.a.fail(e.message)}))},thirdPartyLogin:function(){var e=this;this.canloginConfig&&c.a.loginConfig({}).then((function(t){a.a.clear(),e.loginConfig=t,Number(t.weixinmob_enabled)&&e.isWeixinBrowser&&e.wxLogin()})).catch((function(e){a.a.fail(e.message),a.a.clear()}))},wxLogin:function(){this.$router.replace({path:"/auth/social",query:{type:"wx",weixinmob_key:this.loginConfig.weixinmob_key,redirect:this.$route.query.redirect||"/",callbackType:this.$route.query.callbackType,activityId:this.$route.query.activityId}})},changeLogin:function(){this.$route.query.redirect?this.$router.push({name:"fastlogin",query:{redirect:this.$route.query.redirect}}):this.$router.push({name:"fastlogin"})}})},l=i("a6c2"),d=Object(l.a)(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"login",style:{height:e.bodyHeight+"px"}},[i("span",{staticClass:"login-title"},[e._v("登录账号")]),i("img",{staticClass:"login-avatarimg",attrs:{src:""}}),i("van-field",{staticClass:"login-input e-input",attrs:{autosize:{maxHeight:24},border:!1,type:"textarea",placeholder:"邮箱/手机/用户名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),i("van-field",{staticClass:"login-input e-input",attrs:{border:!1,"error-message":e.errorMessage.password,type:"password",placeholder:"请输入密码"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),i("van-button",{staticClass:"primary-btn mb20",attrs:{disabled:e.btnDisable,type:"default"},on:{click:e.onSubmit}},[e._v("登录")]),i("div",{staticClass:"login-bottom text-center"},[i("router-link",{staticClass:"login-account",attrs:{to:"/setting/password/reset"}},[e._v("忘记密码？  |")]),i("span",{staticClass:"login-account",on:{click:e.jumpRegister}},[e._v("  立即注册  ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.cloudSetting,expression:"cloudSetting"}],staticClass:"login-change",on:{click:e.changeLogin}},[i("img",{staticClass:"login_change-icon",attrs:{src:"static/images/login_change.png"}}),e._v("切换手机快捷登录\n    ")])],1)],1)}),[],!1,null,null,null);t.default=d.exports},d863:function(e,t,i){"use strict";i("a481");var n=i("7067");t.a={data:function(){return{redirect:""}},created:function(){this.redirect=decodeURIComponent(this.$route.fullPath)},methods:{afterLogin:function(){var e=this,t=this.$route.query.redirect?decodeURIComponent(this.$route.query.redirect):"/",i=this.$route.query.skipUrl?decodeURIComponent(this.$route.query.skipUrl):"",a=this.$route.query.callbackType,r=this.$route.query.activityId,s=decodeURIComponent(this.$route.query.callback);setTimeout((function(){if(a)switch(a){case"marketing":Object(n.a)(r,s)}else i?e.$router.replace({path:t,query:{backUrl:i}}):e.$router.replace({path:t})}),2e3)}}}}}]);